/*! @license pzpr.js v29db528 (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["transparenttapa"],{MouseEvent:{use:!0,inputModes:{edit:["number","clear","info-blk"],play:["shade","unshade","peke","info-blk"]},autoedit_func:"qnum",autoplay_func:"cell",mouseinput_clear:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(e.setQnums([]),e.setQans(0),e.setQsub(0),e.draw(),this.mouseCell=e)},inputqnum:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(e!==this.cursor.getc()?this.setcursor(e):this.inputqnum_tapa_main(e),this.mouseCell=e)},inputqnum_tapa_main:function(e){for(var t=e.qnum_states,n=0,r=0;r<t.length;r++)if(this.puzzle.pzpr.util.sameArray(e.qnums,t[r])){n=r;break}"number"===this.inputMode||"auto"===this.inputMode&&"left"===this.btn?n<t.length-1?n++:n=0:0<n?n--:n=t.length-1,e.setQnums(t[n]),e.setQans(0),e.setQsub(0),e.draw()}},KeyEvent:{enablemake:!0,keyinput:function(e){"-"!==e&&this.key_inputqnums(e)}},Cell:{disInputHatena:!0,minnum:0,maxnum:8,qnum_states:[[],[0],[1],[2],[3],[4],[5],[6],[7],[8],[1,1],[1,2],[1,3],[1,4],[1,5],[2,2],[2,3],[2,4],[3,3],[1,1,1],[1,1,2],[1,1,3],[1,1,4],[1,2,2],[1,1,1,1]],isValidQnums:function(e){if(0===e.length)return!0;if(1===e.length)return e[0]<=8;if(2===e.length){for(var t=0,n=0;n<e.length;n++){if(0===e[n])return!1;t+=e[n]}return t<=6}if(3!==e.length)return 4===e.length&&e.toString()===[1,1,1,1].toString();for(var t=0,r=0,n=0;n<e.length;n++){if(0===e[n]||5<=e[n])return!1;1===e[n]&&r++,t+=e[n]}return 1===r?t<=5:2===r?t<=6:3===r},get3x3ShadedClusterLength:function(){for(var i=[],e=[[[-2,-2],[0,-2],[2,-2]],[[-2,0],[0,0],[2,0]],[[-2,2],[0,2],[2,2]]],t=0;t<3;t++)for(var n=0;n<3;n++){var r=this.relcell(e[t][n][0],e[t][n][1]);i.push(!r.isnull&&r.isShade()?1:0)}var l=[[1,0],[-1,0],[0,1],[0,-1]];for(var s=[],t=0;t<3;t++)for(n=0;n<3;n++)1===i[3*t+n]&&s.push(function e(t,n){for(var r=1,s=i[t+3*n]=0;s<l.length;s++){var a=t+l[s][0],u=n+l[s][1];0<=a&&a<3&&0<=u&&u<3&&1===i[a+3*u]&&(r+=e(a,u))}return r}(n,t));return s}},Board:{hasborder:1},AreaShadeGraph:{enabled:!0,coloring:!0},Graphic:{irowakeblk:!0,qanscolor:"black",paint:function(){this.drawBGCells(),this.drawShadedCells(),this.drawDotCells(),this.drawGrid(),this.drawTapaNumbers(),this.drawChassis(),this.drawPekes(),this.drawTarget()}},Encode:{decodePzpr:function(e){this.decodeNumber_tapa()},encodePzpr:function(e){this.encodeNumber_tapa()},decodeNumber_tapa:function(){for(var e=0,t=0,n=this.outbstr,r=this.board,t=0;t<n.length;t++){var s,a,u=r.cell[e],i=n.charAt(t);if(this.include(i,"0","8")?u.qnums=[parseInt(i,10)]:"9"===i?u.qnums=[1,1,1,1]:this.include(i,"a","f")?(a=[],360<=(s=parseInt(n.substr(t,2),36))&&s<396?((a=[0,0])[0]=(s-=360)/6|0,s-=6*a[0],a[1]=s):396<=s&&s<521&&((a=[0,0,0])[0]=(s-=396)/25|0,s-=25*a[0],a[1]=s/5|0,s-=5*a[1],a[2]=s),u.qnums=a,t++):"g"<=i&&i<="z"&&(e+=parseInt(i,36)-16),e++,!r.cell[e])break}this.outbstr=n.substr(t+1)},encodeNumber_tapa:function(){for(var e=0,t="",n=this.board,r=0;r<n.cell.length;r++){var s="",a=n.cell[r].qnums;1===a.length?s=a[0].toString(10):2===a.length?s=(6*a[0]+a[1]+360).toString(36):3===a.length?s=(25*a[0]+5*a[1]+a[2]+396).toString(36):4===a.length?s="9":e++,0===e?t+=s:!s&&20!==e||(t+=(15+e).toString(36)+s,e=0)}0<e&&(t+=(15+e).toString(36)),this.outbstr+=t}},FileIO:{decodeData:function(){this.decodeCellQnumAns_transparenttapa(),this.decodeBorderLine()},encodeData:function(){this.encodeCellQnumAns_transparenttapa(),this.encodeBorderLineIfPresent()},decodeCellQnumAns_transparenttapa:function(){this.decodeCell(function(e,t){if("#"===t)e.qans=1;else if("."!==t){"#"===t.slice(0,1)&&(e.qans=1,t=t.slice(1)),e.qnums=[];for(var n=t.split(/,/),r=0;r<n.length;r++)e.qnums.push("-"!==n[r]?+n[r]:-2)}})},encodeCellQnumAns_transparenttapa:function(){this.encodeCell(function(e){if(0<e.qnums.length){for(var t=[],n=0;n<e.qnums.length;n++)t.push(0<=e.qnums[n]?""+e.qnums[n]:"-");return 1===e.qans?"#"+t.join(",")+" ":t.join(",")+" "}return 1===e.qans?"# ":". "})}},AnsCheck:{checklist:["checkShadeCellExist+","check2x2ShadeCell","checkCountOfClueCell","checkConnectShade+"],checkCountOfClueCell:function(){this.checkAllCell(function(e){if(0===e.qnums.length)return!1;var t=e.get3x3ShadedClusterLength();if(e.qnums.length!==t.length)return!0;for(var n=0;n<e.qnums.length;n++){var r=e.qnums[n];if(-2!==r){r=t.indexOf(r);if(r<0)return!0;t.splice(r,1)}}return!1},"ceTransparentTapaNe")}}});
//# sourceMappingURL=transparenttapa.js.map