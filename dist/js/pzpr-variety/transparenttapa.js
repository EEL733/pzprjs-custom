/*! @license pzpr.js vc297aad (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=[e,t]:pzpr.classmgr.makeCustom(e,t)}(["transparenttapa"],{MouseEvent:{use:!0,inputModes:{edit:["number","clear","info-blk"],play:["shade","unshade","peke","info-blk"]},autoedit_func:"qnum",autoplay_func:"cell",mouseinput_clear:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(e.setQnums([]),e.setQans(0),e.setQsub(0),e.draw(),this.mouseCell=e)},inputqnum:function(){var e=this.getcell();e.isnull||e===this.mouseCell||(e!==this.cursor.getc()?this.setcursor(e):this.inputqnum_tapa_main(e),this.mouseCell=e)},inputqnum_tapa_main:function(e){for(var t=e.qnum_states,n=0,s=0;s<t.length;s++)if(this.puzzle.pzpr.util.sameArray(e.qnums,t[s])){n=s;break}"number"===this.inputMode||"auto"===this.inputMode&&"left"===this.btn?n<t.length-1?n++:n=0:0<n?n--:n=t.length-1,e.setQnums(t[n]),e.setQans(0),e.setQsub(0),e.draw()}},KeyEvent:{enablemake:!0,keyinput:function(e){this.key_inputqnums(e)}},Cell:{minnum:0,maxnum:8,qnum_states:[[],[-2],[0],[1,1,1,1],[1,1,1],[1,1,3],[1,1,4],[1,1,5],[1,1],[1,2,1],[1,2],[1,3,1],[1,3],[1,4],[1,5],[1,6],[1],[2,1,1],[2,1,4],[2,1,5],[2,1],[2,2,1],[2,2],[2,3],[2,4],[2,5],[2],[3,1,1],[3,1,4],[3,1],[3,3],[3],[4,1,1],[4,1],[4,3],[4],[5,1],[5],[6],[7],[8]],isValidQnums:function(e){if(0===e.length)return!0;if(1===e.length)return e[0]<=8;for(var t=0,n=0;n<e.length;n++){if(0===e[n])return!1;t+=0<=e[n]?e[n]:1}return t<=8},get3x3ShadedClusterLength:function(){for(var u=[],e=[[[-2,-2],[0,-2],[2,-2]],[[-2,0],[0,0],[2,0]],[[-2,2],[0,2],[2,2]]],t=0;t<3;t++)for(var n=0;n<3;n++){var s=this.relcell(e[t][n][0],e[t][n][1]);u.push(!s.isnull&&s.isShade()?1:0)}var l=[[1,0],[-1,0],[0,1],[0,-1]];for(var r=[],t=0;t<3;t++)for(n=0;n<3;n++)1===u[3*t+n]&&r.push(function e(t,n){for(var s=1,r=u[t+3*n]=0;r<l.length;r++){var a=t+l[r][0],i=n+l[r][1];0<=a&&a<3&&0<=i&&i<3&&1===u[a+3*i]&&(s+=e(a,i))}return s}(n,t));return r}},Board:{hasborder:1},AreaShadeGraph:{enabled:!0,coloring:!0},Graphic:{irowakeblk:!0,qanscolor:"black",paint:function(){this.drawBGCells(),this.drawShadedCells(),this.drawDotCells(),this.drawGrid(),this.drawTapaNumbers(),this.drawChassis(),this.drawPekes(),this.drawTarget()}},Encode:{decodePzpr:function(e){this.decodeNumber_tapa()},encodePzpr:function(e){this.encodeNumber_tapa()},decodeNumber_tapa:function(){for(var e=0,t=0,n=this.outbstr,s=this.board,t=0;t<n.length;t++){var r=s.cell[e],a=n.charAt(t);if(this.include(a,"0","8"))r.qnums=[parseInt(a,10)];else if("."===a)r.qnums=[-2];else if(this.include(a,"a","f")){var i=parseInt(n.substr(t,2),36),u=[];360<=i&&i<396?((u=[0,0])[0]=(i-=360)/6|0,i-=6*u[0],u[1]=i):396<=i&&i<460?((u=[0,0,0])[0]=(i-=396)/16|0,i-=16*u[0],u[1]=i/4|0,i-=4*u[1],u[2]=i):460<=i&&i<476&&((u=[0,0,0,0])[0]=(i-=460)/8|0,i-=8*u[0],u[1]=i/4|0,i-=4*u[1],u[2]=i/2|0,i-=2*u[2],u[3]=i);for(var l=0;l<4;l++)0===u[l]&&(u[l]=-2);r.qnums=u,t++}else"g"<=a&&a<="z"&&(e+=parseInt(a,36)-16);if(e++,!s.cell[e])break}this.outbstr=n.substr(t+1)},encodeNumber_tapa:function(){for(var e=0,t="",n=this.board,s=0;s<n.cell.length;s++){var r="",a=n.cell[s].qnums;1===a.length?r=-2===a[0]?".":a[0].toString(10):2===a.length?r=(6*(0<a[0]?a[0]:0)+(0<a[1]?a[1]:0)+360).toString(36):3===a.length?r=(16*(0<a[0]?a[0]:0)+4*(0<a[1]?a[1]:0)+(0<a[2]?a[2]:0)+396).toString(36):4===a.length?r=(8*(0<a[0]?1:0)+4*(0<a[1]?1:0)+2*(0<a[2]?1:0)+(0<a[3]?1:0)+460).toString(36):e++,0===e?t+=r:!r&&20!==e||(t+=(15+e).toString(36)+r,e=0)}0<e&&(t+=(15+e).toString(36)),this.outbstr+=t}},FileIO:{decodeData:function(){this.decodeCellQnumAns_transparenttapa(),this.decodeBorderLine()},encodeData:function(){this.encodeCellQnumAns_transparenttapa(),this.encodeBorderLineIfPresent()},decodeCellQnumAns_transparenttapa:function(){this.decodeCell(function(e,t){if("#"===t)e.qans=1;else if("+"===t)e.qsub=1;else if("."!==t)for(var n=t.slice(0,1),s=("#"===n?(e.qans=1,t=t.slice(1)):"+"===n&&(e.qsub=1,t=t.slice(1)),e.qnums=[],t.split(/,/)),r=0;r<s.length;r++)e.qnums.push("-"!==s[r]?+s[r]:-2)})},encodeCellQnumAns_transparenttapa:function(){this.encodeCell(function(e){if(0<e.qnums.length){for(var t=[],n=0;n<e.qnums.length;n++)t.push(0<=e.qnums[n]?""+e.qnums[n]:"-");return 1===e.qans?"#"+t.join(",")+" ":1===e.qsub?"+"+t.join(",")+" ":t.join(",")+" "}return 1===e.qans?"# ":1===e.qsub?"+ ":". "})}},AnsCheck:{checklist:["checkShadeCellExist+","check2x2ShadeCell","checkCountOfClueCell","checkConnectShade+"],checkCountOfClueCell:function(){this.checkAllCell(function(e){if(0===e.qnums.length)return!1;var t=e.get3x3ShadedClusterLength();if(e.qnums.length!==t.length)return!0;for(var n=0;n<e.qnums.length;n++){var s=e.qnums[n];if(-2!==s){s=t.indexOf(s);if(s<0)return!0;t.splice(s,1)}}return!1},"ceTransparentTapaNe")}}});
//# sourceMappingURL=transparenttapa.js.map